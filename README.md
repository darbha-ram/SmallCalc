# SmallCalc

SmallCalc is a simple arithmetic expression evaluator written in Java. It is based on [JavaCC](https://javacc.java.net).

## Prerequisities

* JDK 1.8+
* Gradle v2.14+

JavaCC is also a prerequisite, but it doesn't have to be explicitly installed as Gradle handles that dependency.

## Installing

To get a development environment running:
- Install a recent version of the Java SDK
- Install [Gradle2.14+](https://gradle.org)
- Ensure gradleroot/bin is in your PATH.
- Clone the repo from [Github](https://github.com/darbha-ram/SmallCalc.git).


## Implementation 

This is a brief description of the implementation, it can be skipped if only interested in deploying and executing the application.

The application source is contained in src/main/javacc/SmallCalc.jj.  The "jj" file is a specification of the lexical and production rules of the grammar to be parsed by JavaCC.  With each production, Java code to be executed when segments of a rule are matched are provided.

For a description of "jj" file specification, see [JavaCC Documentation](http://javacc.java.net/doc/docindex.html).

Grammar rules specified in SmallCalc.jj:
```
Expr := AddExpr | MultExpr | SubExpr | DivExpr | UnaryExpr | LetExpr
AddExpr := "add" "(" Expr "," Expr ")"
MultExpr := "mult" "(" Expr "," Expr ")"
SubExpr := "sub" "(" Expr "," Expr ")"
DivExpr := "div" "(" Expr "," Expr ")"
LetExpr := "let" "(" AlphaLiteral "," Expr "," Expr ")"
UnaryExpr := IntegerLiteral | AlphaLiteral
```

Lexical tokens are defined as:

```
IntegerLiteral := ( ("-" DIGIT) | DIGIT ) [DIGIT]\*
AlphaLiteral := [a-zA-z]\*
```


## Build and Deploy

The command 'gradle build' executes the pre-compile step of running JavaCC on the grammar file, to generate Java source code for the parser. It then compiles that code and builds distributions.

```
$ cd SmallCalc (root folder of git repo)
$ gradle build
$ cd build/distributions
$ unzip SmallCalc.zip
$ cd SmallCalc/bin
```

## Execution Examples

Gradle generates scripts to execute the application, handling classpaths and other runtime details.  On Linux, use the executable script SmallCalc, on Windows use SmallCalc.bat.  SmallCalc uses log4j2 for logging. The file log4j.xml in build/ configures log4j. The output file is configured as build/smallcalc.log as default.

To get usage info:

```
$ ./SmallCalc
```

To evaluate expression and filter logs at the level set in log4j.xml:

```
$ ./SmallCalc "add(1, mult(3,4))"
```

To evaluate expression and filter logs at INFO level:

```
$ ./SmallCalc "add(1, mult(3,4))" INFO
```

## Running unit tests

JUnit tests are in src/test/java/SmallCalcTest.java.  They can be executed by:

```
$ gradle test
```

For each test, console output will indicate PASS, FAIL or SKIP.  A test report is also generated by gradle at build/reports/tests/index.html.


## Author

* **Ram Darbha**

## License

MIT License

